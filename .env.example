# ========================================
# VOCAID BACKEND - ENVIRONMENT CONFIGURATION
# ========================================
# Copy this file to .env and fill in your values
# 
# Environment Strategy:
# - development: Local Docker PostgreSQL, ngrok for webhooks
# - staging: EC2 instance, PostgreSQL, no Azure services
# - production: Azure PostgreSQL, Blob Storage, Redis Cache
# ========================================

# Server Configuration
PORT=3001
NODE_ENV=development  # Options: development, staging, production

# ========================================
# DATABASE CONFIGURATION
# ========================================

# PostgreSQL Connection URL
# Development (Docker): postgresql://Vocaid:Vocaid_dev_password@localhost:5432/Vocaid
# Staging (EC2): postgresql://user:password@localhost:5432/Vocaid
# Production (Azure): postgresql://user:password@server.postgres.database.azure.com:5432/Vocaid?sslmode=require
DATABASE_URL=postgresql://Vocaid:Vocaid_dev_password@localhost:5432/Vocaid

# Docker PostgreSQL credentials (used by docker-compose.yml)
POSTGRES_USER=Vocaid
POSTGRES_PASSWORD=Vocaid_dev_password
POSTGRES_DB=Vocaid

# pgAdmin credentials (optional, for database UI)
PGADMIN_EMAIL=admin@Vocaid.ai
PGADMIN_PASSWORD=admin

# ========================================
# AI SERVICES
# ========================================

# OpenAI API Key (Primary AI service)
OPENAI_API_KEY=sk-proj-your-openai-key

# Gemini API Key (Fallback AI service - optional)
GEMINI_API_KEY=your-gemini-key

# ========================================
# RETELL AI CONFIGURATION
# ========================================

RETELL_API_KEY=key_your_retell_key

# Main Multilingual Agent (PT, EN, ES, FR, RU, HI)
RETELL_AGENT_ID=agent_your_main_agent

# Chinese Mandarin Agent (zh-CN only)
RETELL_AGENT_ID_ZH=agent_your_chinese_agent

# ========================================
# MERCADO PAGO PAYMENTS
# ========================================

# Production credentials
MERCADOPAGO_ACCESS_TOKEN=APP_USR-your-prod-token
MERCADOPAGO_PUBLIC_KEY=APP_USR-your-prod-key

# Test/Sandbox credentials (used when NODE_ENV=development)
MERCADOPAGO_TEST_ACCESS_TOKEN=APP_USR-your-test-token
MERCADOPAGO_TEST_PUBLIC_KEY=APP_USR-your-test-key

# ========================================
# CLERK AUTHENTICATION
# ========================================

CLERK_SECRET_KEY=sk_test_your_clerk_secret
CLERK_WEBHOOK_SECRET=whsec_your_webhook_secret

# ========================================
# TWILIO CONFIGURATION (for Phone Verification)
# ========================================
# Get these from: https://console.twilio.com/
# Required for phone number verification during signup

TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_MESSAGING_SERVICE_SID=MGxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ========================================
# URLS - IMPORTANT FOR CORS AND WEBHOOKS
# ========================================

# Frontend URL (for CORS and payment redirects)
FRONTEND_URL=https://your-frontend-url.com

# Webhook base URL (must be publicly accessible)
WEBHOOK_BASE_URL=https://your-backend-url.com

# ========================================
# LOGGING
# ========================================

LOG_LEVEL=error  # Options: error, warn, info, debug

# ========================================
# CREDITS CONFIGURATION
# ========================================

FREE_TRIAL_CREDITS=1
FREE_TRIAL_CREDITS_PHONE_VERIFIED=1
FREE_TRIAL_CREDITS_LINKEDIN_VERIFIED=1

# ========================================
# PAYPAL (Optional)
# ========================================

PAYPAL_CLIENT_ID=your-paypal-client-id
PAYPAL_CLIENT_SECRET=your-paypal-secret
PAYPAL_MODE=sandbox  # sandbox or live
PAYPAL_SANDBOX_URL=https://api-m.sandbox.paypal.com

# ========================================
# CLOSED BETA FEEDBACK SYSTEM
# ========================================

BETA_FEEDBACK_ENABLED=true
# FORMSPREE_BETA_FEEDBACK_URL=https://formspree.io/f/your_form_id

# ========================================
# AZURE BLOB STORAGE CONFIGURATION
# ========================================
# Required for resume file storage in all environments

# ----------------------------------------
# Development (Azurite Emulator)
# ----------------------------------------
# Use with docker-compose: docker-compose up azurite
# Azurite default connection string:
# DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1

# ----------------------------------------
# Production (Azure Blob Storage)
# ----------------------------------------
# Get from: Azure Portal > Storage Accounts > Access Keys
# Connection string format:
# DefaultEndpointsProtocol=https;AccountName=xxx;AccountKey=xxx;EndpointSuffix=core.windows.net

# For development with Azurite:
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1

# Container names (will be created if they don't exist)
AZURE_STORAGE_CONTAINER_RESUMES=resumes
AZURE_STORAGE_CONTAINER_EXPORTS=exports

# Feature flag: Enable Azure Blob storage for files
# REQUIRED: Must be true for resume uploads to work
AZURE_BLOB_STORAGE_ENABLED=true

# ----------------------------------------
# Azure Redis Cache (Session/Hot-path Caching)
# ----------------------------------------
# Reduces database load for frequently accessed data
# Get from: Azure Portal > Redis Cache > Access Keys

AZURE_REDIS_HOST=your-cache.redis.cache.windows.net
AZURE_REDIS_PORT=6380
AZURE_REDIS_PASSWORD=your-redis-key
AZURE_REDIS_TLS_ENABLED=true

# Feature flag: Enable Redis caching
# false = In-memory only (current)
# true = Redis for distributed caching
AZURE_REDIS_ENABLED=false

# ========================================
# ANALYTICS CONFIGURATION
# ========================================

# Enable database-backed analytics caching
ANALYTICS_CACHING_ENABLED=true

# Cache TTL in seconds
ANALYTICS_CACHE_TTL_DASHBOARD=300   # 5 minutes
ANALYTICS_CACHE_TTL_GLOBAL=3600     # 1 hour

# Scheduled job cron expression (every hour)
ANALYTICS_SNAPSHOT_CRON=0 * * * *

# Enable scheduled analytics computation
# Set to true when ready to run background jobs
ANALYTICS_SCHEDULED_JOBS_ENABLED=false

# ========================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ========================================
# 
# Phase 1: Staging (EC2 + PostgreSQL)
# [ ] Set NODE_ENV=staging
# [ ] Configure DATABASE_URL for EC2 PostgreSQL
# [ ] Update FRONTEND_URL and WEBHOOK_BASE_URL
# [ ] Verify all API integrations work
#
# Phase 2: Azure Blob Storage
# [ ] Create Azure Storage Account
# [ ] Set AZURE_STORAGE_CONNECTION_STRING
# [ ] Set AZURE_BLOB_STORAGE_ENABLED=true
# [ ] Migrate existing PDFs from database
#
# Phase 3: Azure Redis Cache
# [ ] Create Azure Cache for Redis (Standard tier recommended)
# [ ] Configure AZURE_REDIS_* settings
# [ ] Set AZURE_REDIS_ENABLED=true
# [ ] Monitor cache hit rates
#
# Phase 4: Scheduled Jobs
# [ ] Set ANALYTICS_SCHEDULED_JOBS_ENABLED=true
# [ ] Verify cron job execution
# [ ] Monitor analytics snapshot generation
